区块链：

  区块链提供比特币的公共账本，这是一份按顺序和时间戳记录的交易记录。该系统用于防范双重花费和修改先前的交易记录。

简介：

  比特币网络中的每个完整节点都独立存储一个区块链，其中仅包含由该节点验证的区块。当多个节点的区块链中都包含相同的区块时，它们被视为达成共识。
这些节点遵循的用于维持共识的验证规则称为共识规则。本节描述了比特币核心使用的许多共识规则。

【图片1】

  上图显示了一个简化版本的区块链。一个或多个新交易的区块被收集到区块的交易数据部分。
每个交易的副本都被哈希，然后哈希被配对，再次哈希，再次配对，一直哈希，直到只剩下一个哈希，即默克尔树的默克尔根。

   默克尔根存储在区块头中。每个区块还存储前一个区块头的哈希，将区块链接在一起。这确保在不修改记录它的区块及其后续区块的情况下，无法修改交易。
   
    交易也被链接在一起。比特币钱包软件给人的印象是聪发送到钱包，但比特币实际上是在交易之间移动。每个交易都花费了先前在一个或多个早期交易中收到的聪，因此一个交易的输入是先前交易的输出。
【图片2】
  一笔交易可以创建多个输出，例如在向多个地址发送时，但特定交易的每个输出在区块链中只能作为输入使用一次。任何后续引用都是禁止的双重花费，即尝试两次花费相同的聪。

  输出与交易标识符（TXIDs）相绑定，这些标识符是已签名交易的哈希值。

  因为特定交易的每个输出只能花费一次，包含在区块链中的所有交易的输出可以被归类为未花费交易输出（UTXOs）或已花费交易输出。为了使付款有效，它只能使用UTXOs作为输入。

  忽略coinbase交易（稍后描述），如果交易输出的价值超过其输入，交易将被拒绝——但如果输入超过输出的价值，该交易中包含的比特币矿工可以将价值差额视为交易费用。
例如，在上面的示例中，每个交易花费的satoshi比其综合输入收到的少10,000satoshi，实际上支付了一个10,000satoshi的交易费用。

Proof Of Work
  区块链由网络上的匿名对等方共同维护，因此比特币要求每个区块都证明在其创建过程中投入了大量的工作，以确保想要修改过去区块的不可信对等方必须比只想向区块链添加新区块的诚实对等方付出更多努力。

  将区块链接在一起使得在不修改所有后续区块的情况下修改任何区块中包含的交易变得不可能。因此，修改特定区块的成本随着每个新区块加入区块链而增加，放大了工作证明的效果。

  比特币中使用的工作证明利用了密码哈希的表面上随机的性质。一个良好的密码哈希算法将任意数据转换为一个表面上随机的数字。如果以任何方式修改数据并重新运行哈希，将产生一个新的看似随机的数字，因此无法修改数据以使哈希数可预测。

  为了证明你为创建一个区块付出了额外的努力，你必须创建一个区块头的哈希，其值不超过某个特定值。例如，如果最大可能的哈希值为2^256 − 1，你可以通过产生小于2^255的哈希值来证明你尝试了多达两个组合。

  在上述示例中，你平均每两次尝试就会产生一个成功的哈希。你甚至可以估算特定哈希尝试将生成低于目标阈值的数字的概率。比特币假设目标阈值越低，平均需要尝试的哈希次数就越多，呈线性概率。
  新的区块只有在其哈希至少与共识协议期望的难度值一样具有挑战性时，才会被添加到区块链中。每2,016个区块，网络使用存储在每个区块头中的时间戳来计算生成这2,016个区块的第一个和最后一个之间经过的秒数。
理想值为1,209,600秒（两周）。
          如果生成2,016个区块的时间少于两周，预期的难度值将按比例增加（最多300%），以确保下一个2,016个区块的生成时间正好为两周，如果哈希值以相同的速率进行检查。
          如果生成区块的时间超过两周，预期的难度值将按比例减少（最多75%），原因相同。

  （由于比特币核心实现中的一个偏差错误，每2,016个区块的难度更新一次，仅使用来自2,015个区块的时间戳，导致轻微的偏差。）

  因为每个区块头必须哈希为低于目标阈值的值，并且因为每个区块都链接到其前面的区块，所以传播修改后的区块需要（平均而言）
与创建原始区块并在当前时间之间的整个比特币网络消耗相同的哈希功率。只有在获得网络哈希功率的大多数情况下，您才能可靠地执行
对交易历史进行51%的攻击（尽管应注意，即使不到50%的哈希功率仍有很大机会执行此类攻击）。

  区块头提供了几个易于修改的字段，例如专用的随机数字段，因此获取新的哈希不需要等待新的交易。
此外，仅对80字节的区块头进行工作量证明的哈希，因此在区块中包含大量交易数据不会通过额外的I/O减慢哈希速度，
添加额外的交易数据只需要重新计算Merkle树中的祖先哈希。


